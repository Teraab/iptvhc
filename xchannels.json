<!DOCTYPE html>
<html lang="en">

<head>
    <script>(function (s) { s.dataset.zone = '10408286', s.src = 'https://al5sm.com/tag.min.js' })([document.documentElement, document.body].filter(Boolean).pop().appendChild(document.createElement('script')))</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#0a0a0a">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Iptv Tv web</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jwplayer.com/libraries/IDzF9Zmk.js"></script>

    <style>
        {
            scroll-behavior: smooth;
        }

        * {
            -webkit-tap-highlight-color: transparent;
        }

        body {
            touch-action: manipulation;
        }

        :root {
            --primary: #8a2be2;
            --primary-dark: #6a1cb8;
            --primary-light: #9d4edd;
            --secondary: #00d4ff;
            --dark: #0a0a0a;
            --dark-light: #111111;
            --dark-lighter: #1a1a1a;
            --light: #ffffff;
            --light-gray: #f0f0f0;
            --gray: #a1a1a1;
            --success: #00ff88;
            --warning: #ffaa00;
            --shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            --radius: 12px;
            --transition: all 0.3s ease;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: var(--dark);
            color: var(--light);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .main-header {
            background: rgba(10, 10, 10, 0.95);
            backdrop-filter: blur(10px);
            padding: 15px 30px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 1px solid rgba(138, 43, 226, 0.2);
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: var(--shadow);
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-icon {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }

        .logo-text {
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(to right, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .search-container {
            flex-grow: 1;
            max-width: 500px;
            margin: 0 25px;
            position: relative;
        }

        .search-box {
            width: 100%;
            padding: 12px 20px;
            border-radius: 30px;
            border: 1px solid rgba(138, 43, 226, 0.3);
            background: rgba(26, 26, 26, 0.8);
            color: var(--light);
            font-size: 0.95rem;
            transition: var(--transition);
        }

        .search-box:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(138, 43, 226, 0.2);
        }

        .search-icon {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray);
        }

        .user-controls {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .select-container {
            position: relative;
        }

        .category-select {
            padding: 10px 15px;
            border-radius: 30px;
            border: 1px solid rgba(138, 43, 226, 0.3);
            background: rgba(26, 26, 26, 0.8);
            color: var(--light);
            font-size: 0.9rem;
            appearance: none;
            padding-right: 40px;
            min-width: 180px;
            cursor: pointer;
            transition: var(--transition);
        }

        .category-select:focus {
            outline: none;
            border-color: var(--primary);
        }

        .select-arrow {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            pointer-events: none;
        }

        .main-container {
            display: flex;
            height: calc(100vh - 75px);
            overflow: hidden;
            padding: 20px;
            gap: 20px;
        }

        .player-section {
            flex: 1.8;
            display: flex;
            flex-direction: column;
            background: rgba(0, 0, 0, 0.9);
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow);
        }

        .player-wrap {
            width: 100%;
            aspect-ratio: 16/9;
            background: #000;
        }

        .player-wrap {
            width: 100%;
            height: 100%;
            position: relative;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.7);
            border-radius: var(--radius);
            overflow: hidden;
            background: #000;
        }

        #my-jwplayer {
            width: 100% !important;
            height: 100% !important;
        }

        .now-playing {
            background: rgba(26, 26, 26, 0.8);
            padding: 15px 20px;
            border-top: 1px solid rgba(138, 43, 226, 0.2);
        }

        .now-playing h3 {
            font-size: 0.9rem;
            color: var(--gray);
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .now-playing h3 i {
            color: var(--secondary);
        }

        .channel-name {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--light);
            margin-bottom: 5px;
        }

        .channel-category {
            display: inline-block;
            background: rgba(138, 43, 226, 0.2);
            color: var(--primary-light);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
        }

        .channels-section {
            width: 500px;
            display: flex;
            flex-direction: column;
            background: rgba(10, 10, 10, 0.8);
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow);
            min-width: 0;
        }

        .section-header {
            padding: 20px;
            border-bottom: 1px solid rgba(138, 43, 226, 0.2);
            flex-shrink: 0;
        }

        .section-title {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .section-title h2 {
            font-size: 1.4rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-title h2 i {
            color: var(--secondary);
        }

        .channels-count {
            background: var(--primary);
            color: white;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .channels-container {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
        }

        .channels-container::-webkit-scrollbar {
            width: 6px;
        }

        .channels-container::-webkit-scrollbar-track {
            background: rgba(26, 26, 26, 0.3);
        }

        .channels-container::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 3px;
        }

        .channels-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 18px;
        }

        .channel-card {
            background: linear-gradient(135deg, rgba(26, 26, 26, 0.9), rgba(37, 37, 37, 0.9));
            border-radius: var(--radius);
            overflow: hidden;
            cursor: pointer;
            transition: var(--transition);
            border: 1px solid rgba(255, 255, 255, 0.05);
            position: relative;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .channel-card:hover {
            transform: translateY(-5px);
            border-color: rgba(138, 43, 226, 0.5);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }

        .channel-card.active {
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(138, 43, 226, 0.3);
        }

        .channel-card.active::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(to right, var(--primary), var(--secondary));
        }

        .channel-logo {
            width: 100%;
            height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            background: rgba(0, 0, 0, 0.7);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .channel-logo img {
            max-width: 100%;
            max-height: 80px;
            object-fit: contain;
            transition: opacity 0.3s ease;
        }

        .channel-info {
            padding: 15px;
            flex-grow: 1;
            position: relative;
        }

        .channel-title {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--light);
            line-height: 1.3;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .channel-cat {
            font-size: 0.8rem;
            color: var(--gray);
        }

        .play-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(138, 43, 226, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: var(--transition);
            border-radius: var(--radius);
        }

        .channel-card:hover .play-overlay {
            opacity: 1;
        }

        .play-overlay i {
            background: white;
            color: var(--primary);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            transform: scale(0.8);
            transition: var(--transition);
        }

        .channel-card:hover .play-overlay i {
            transform: scale(1);
        }

        .loading-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 50px;
            grid-column: 1 / -1;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 3px solid rgba(255, 255, 255, 0.1);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        .empty-state {
            text-align: center;
            padding: 50px 20px;
            grid-column: 1 / -1;
        }

        .empty-state i {
            font-size: 3rem;
            color: var(--gray);
            margin-bottom: 15px;
        }

        .player-placeholder {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, rgba(26, 26, 26, 0.8), rgba(15, 15, 15, 0.9));
            color: var(--gray);
            padding: 20px;
            text-align: center;
        }

        .player-placeholder i {
            font-size: 4rem;
            margin-bottom: 20px;
            background: linear-gradient(to right, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .player-placeholder h3 {
            font-size: 1.5rem;
            margin-bottom: 10px;
            color: var(--light);
        }


        /* Splash Screen */
        .splash-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(10, 10, 10, 0.95);
            backdrop-filter: blur(10px);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            /* No auto-hide animation */
        }

        @keyframes fadeOut {
            to {
                opacity: 0;
                visibility: hidden;
            }
        }

        .splash-content {
            text-align: center;
            animation: slideUp 0.8s ease-out;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .splash-logo {
            margin-bottom: 30px;
        }

        .splash-logo i {
            font-size: 5rem;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {

            0%,
            100% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.1);
            }
        }

        .splash-title {
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(to right, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 15px;
        }

        .splash-subtitle {
            font-size: 1.1rem;
            color: var(--gray);
            margin-bottom: 40px;
        }

        .social-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .social-btn {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 15px 30px;
            border-radius: 50px;
            text-decoration: none;
            font-weight: 600;
            font-size: 1rem;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            position: relative;
            overflow: hidden;
        }

        .social-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }

        .social-btn:hover::before {
            left: 100%;
        }

        .whatsapp-btn {
            background: linear-gradient(135deg, #25D366, #128C7E);
            color: white;
        }

        .whatsapp-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(37, 211, 102, 0.4);
            color: white;
        }

        .telegram-btn {
            background: linear-gradient(135deg, #0088cc, #005f8c);
            color: white;
        }

        .telegram-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 136, 204, 0.4);
            color: white;
        }

        .social-btn i {
            font-size: 1.5rem;
        }

        .splash-timer {
            margin-top: 30px;
            font-size: 0.9rem;
            color: var(--gray);
        }

        .splash-timer .timer-number {
            color: var(--secondary);
            font-weight: 700;
            font-size: 1.2rem;
        }



        .splash-timer {
            margin-top: 30px;
            font-size: 1rem;
            color: var(--gray);
        }

        .splash-timer .timer-number {
            color: var(--secondary);
            font-weight: 700;
            font-size: 1.4rem;
            display: inline-block;
            min-width: 25px;
            text-align: center;
        }

        .skip-button {
            margin-top: 25px;
            padding: 12px 35px;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            border: 2px solid var(--primary-light);
            border-radius: 50px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(138, 43, 226, 0.3);
            display: none;
            align-items: center;
            gap: 10px;
            opacity: 0;
            transform: translateY(10px);
        }

        .skip-button.show {
            display: inline-flex;
            animation: skipButtonAppear 0.5s ease-out forwards;
        }

        @keyframes skipButtonAppear {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .skip-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(138, 43, 226, 0.5);
            background: linear-gradient(135deg, var(--primary-light), var(--primary));
        }

        .skip-button i {
            font-size: 1.2rem;
        }

        @media (max-width: 768px) {
            .splash-title {
                font-size: 2rem;
            }

            .splash-subtitle {
                font-size: 1rem;
            }

            .social-buttons {
                flex-direction: column;
                gap: 15px;
            }

            .social-btn {
                width: 100%;
                max-width: 300px;
            }

            .splash-logo i {
                font-size: 4rem;
            }
        }

        @media (max-width: 480px) {
            .splash-title {
                font-size: 1.5rem;
            }

            .splash-subtitle {
                font-size: 0.9rem;
            }

            .social-btn {
                padding: 12px 25px;
                font-size: 0.9rem;
            }
        }


        @media (max-width: 1200px) {
            .channels-section {
                width: 450px;
            }

            .channels-grid {
                grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            }
        }

        @media (max-width: 992px) {
            .main-container {
                flex-direction: column;
                height: auto;
                min-height: calc(100vh - 75px);
                padding: 15px;
                gap: 15px;
            }

            .player-section {
                position: sticky;
                top: 75px;
                z-index: 5;
                width: 100%;
                height: 45vh;
                min-height: 300px;
                flex-shrink: 0;
                border-radius: var(--radius);
            }

            .channels-section {
                width: 100%;
                height: 50vh;
                flex-grow: 1;
            }

            .channels-grid {
                grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
            }

            .search-container {
                max-width: 350px;
            }
        }

        @media (max-width: 768px) {
            .main-header {
                flex-wrap: wrap;
                padding: 12px 15px;
            }

            .logo-container {
                order: 1;
                width: 100%;
                margin-bottom: 10px;
                justify-content: center;
            }

            .search-container {
                order: 3;
                max-width: 100%;
                margin: 10px 0;
            }

            .user-controls {
                order: 2;
                width: 100%;
                justify-content: space-between;
            }

            .channels-grid {
                grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
                gap: 12px;
            }

            .section-title h2 {
                font-size: 1.2rem;
            }

            .player-section {
                height: 40vh;
                min-height: 250px;
            }

            .channels-section {
                height: 50vh;
            }
        }

        @media (max-width: 576px) {

            .main-header {
                padding: 8px 10px;
            }

            .player-section {
                height: 32vh;
                min-height: 200px;
            }

            .channels-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .channel-logo {
                height: 80px;
            }

            .channel-title {
                font-size: 0.85rem;
            }

            .category-select {
                font-size: 0.8rem;
            }
        }

        .search-box {
            padding: 10px 15px;
            font-size: 0.9rem;
        }

        .logo-text {
            font-size: 1.3rem;
        }

        @media (max-width: 480px) {
            .channels-grid {
                grid-template-columns: repeat(auto-fill, minmax(110px, 1fr));
            }

            .channel-logo {
                height: 90px;
            }

            .section-header {
                padding: 15px;
            }

            .channels-container {
                padding: 15px;
            }

            .player-section {
                min-height: 200px;
            }

            .now-playing {
                padding: 12px 15px;
            }

            .channel-name {
                font-size: 1.1rem;
            }

            .channel-card:focus,
            .channel-card.tv-focus {
                outline: 3px solid var(--secondary);
                transform: scale(1.05);
            }

            @media (min-width: 1600px) {
                .channels-grid {
                    grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
                }

                .channel-logo {
                    height: 160px;
                }

                .channel-title {
                    font-size: 1.1rem;
                }

                .player-section {
                    height: 70vh;
                }
            }


        }
    </style>
</head>

<body>
    <!-- Splash Screen -->
    <div class="splash-screen" id="splashScreen">
        <div class="splash-content">
            <div class="splash-logo">
                <i class="fas fa-satellite-dish"></i>
            </div>
            <h1 class="splash-title">IPTV WEB</h1>
            <p class="splash-subtitle">Join our community for updates & support</p>

            <div class="social-buttons">
                <a href="https://whatsapp.com/channel/0029Vb7cjOfBVJlB5lnxNr1Q" class="social-btn whatsapp-btn"
                    target="_blank">
                    <i class="fab fa-whatsapp"></i>
                    <span>Join WhatsApp</span>
                </a>
                <a href="https://t.me/free_trick_zone" class="social-btn telegram-btn" target="_blank">
                    <i class="fab fa-telegram"></i>
                    <span>Join Telegram</span>
                </a>
            </div>

            <div class="splash-timer" id="timerDisplay">
                Please wait <span class="timer-number" id="timerCount">5</span> seconds...
            </div>

            <button class="skip-button" id="skipButton">
                <i class="fas fa-forward"></i>
                <span>Skip & Continue</span>
            </button>
        </div>
    </div>


    <header class="main-header">
        <div class="logo-container">
            <div class="logo-icon">
                <i class="fas fa-satellite-dish"></i>
            </div>
            <div class="logo-text">IPTV WEB</div>
        </div>

        <div class="search-container">
            <input type="text" class="search-box" id="searchBox" placeholder="Search channels...">
            <i class="fas fa-search search-icon"></i>
        </div>

        <div class="user-controls">
            <div class="select-container">
                <select class="category-select" id="categoryFilter">
                    <option value="">All Categories</option>
                </select>
                <i class="fas fa-chevron-down select-arrow"></i>
            </div>
        </div>
    </header>

    <div class="main-container">
        <section class="player-section">
            <div class="player-container">
                <div class="player-wrap">
                    <div class="player-placeholder" id="playerPlaceholder">
                        <i class="fas fa-play-circle"></i>
                        <h3>Select a Channel to Start Streaming</h3>
                        <p>Click on any channel card to instantly start watching</p>
                    </div>

                    <div id="my-jwplayer" style="display: none;"></div>
                </div>
            </div>

            <div class="now-playing" id="nowPlaying" style="display: none;">
                <h3><i class="fas fa-broadcast-tower"></i> NOW PLAYING</h3>
                <div class="channel-name" id="currentChannelName">Channel Name</div>
                <div class="channel-category" id="currentChannelCategory">Category</div>
            </div>
        </section>

        <section class="channels-section">
            <div class="section-header">
                <div class="section-title">
                    <h2><i class="fas fa-tv"></i> Live Channels</h2>
                    <div class="channels-count" id="channelsCount">0 Channels</div>
                </div>
            </div>

            <div class="channels-container">
                <div class="channels-grid" id="channelGrid">
                    <div class="loading-container">
                        <div class="spinner"></div>
                        <div>Loading channels...</div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <script>
        // Global variables
        let animationFrameId = null;
        let lastSearchTime = 0;
        const searchDebounceDelay = 300;

        // Placeholder logo SVG for missing channel images
        const placeholderLogo = 'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" width="100" height="100"><rect width="100" height="100" fill="%23111111" opacity="0.7"/><text x="50" y="55" text-anchor="middle" fill="%23888888" font-family="Arial" font-size="14">TV</text></svg>';

        // DOM Content Loaded Event

        // Splash Screen - Timer and Skip Button
        const splashScreen = document.getElementById('splashScreen');
        const skipButton = document.getElementById('skipButton');
        const timerDisplay = document.getElementById('timerDisplay');
        const timerCount = document.getElementById('timerCount');

        let countdown = 5;

        // Countdown timer
        const timer = setInterval(() => {
            countdown--;
            if (timerCount) {
                timerCount.textContent = countdown;
            }

            if (countdown <= 0) {
                clearInterval(timer);
                // Hide timer and show skip button
                if (timerDisplay) {
                    timerDisplay.style.display = 'none';
                }
                if (skipButton) {
                    skipButton.classList.add('show');
                }
            }
        }, 1000);

        // Function to hide splash
        function hideSplash() {
            if (splashScreen) {
                splashScreen.style.animation = 'fadeOut 0.3s ease-out forwards';
                setTimeout(() => {
                    splashScreen.style.display = 'none';
                }, 300);
            }
        }

        // Skip button click
        if (skipButton) {
            skipButton.addEventListener('click', hideSplash);
        }

        // Social buttons - open link but don't hide splash
        const socialButtons = document.querySelectorAll('.social-btn');
        socialButtons.forEach(btn => {
            btn.addEventListener('click', (e) => {
                // Link will open normally, splash stays visible
            });
        });


        document.addEventListener('DOMContentLoaded', function () {

            // Get DOM elements
            const channelGrid = document.getElementById('channelGrid');
            const categoryFilter = document.getElementById('categoryFilter');
            const searchBox = document.getElementById('searchBox');
            const playerPlaceholder = document.getElementById('playerPlaceholder');
            const nowPlaying = document.getElementById('nowPlaying');
            const currentChannelName = document.getElementById('currentChannelName');
            const currentChannelCategory = document.getElementById('currentChannelCategory');
            const channelsCount = document.getElementById('channelsCount');

            // Variables
            let allChannels = [];
            let filteredChannels = [];
            let currentChannel = null;
            let categorySet = new Set();
            let jwPlayer = null;
            let lazyLoadObserver = null;

            // Setup Intersection Observer for lazy loading images
            if ('IntersectionObserver' in window) {
                lazyLoadObserver = new IntersectionObserver(entries => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            const img = entry.target;
                            if (img.dataset.src) {
                                img.src = img.dataset.src;
                                delete img.dataset.src;
                            }
                        }
                    });
                }, {
                    rootMargin: '50px 0px',
                    threshold: 0.01
                });
            }

            // Fetch channels data from JSON
            fetch('xchannels.json')
                .then(response => {
                    if (!response.ok) throw new Error('Network response was not ok');
                    return response.json();
                })
                .then(data => {
                    channelGrid.innerHTML = '';
                    const channelsArray = [];

                    // Process channels data
                    for (const category in data) {
                        if (data.hasOwnProperty(category)) {
                            categorySet.add(category);
                            const categoryChannels = data[category];

                            for (let i = 0; i < categoryChannels.length; i++) {
                                const channel = categoryChannels[i];
                                channel.category = category;
                                channelsArray.push(channel);
                            }
                        }
                    }

                    allChannels = channelsArray;
                    filteredChannels = [...allChannels];

                    // Populate category filter dropdown
                    categorySet.forEach(category => {
                        const option = document.createElement('option');
                        option.value = category;
                        option.textContent = category;
                        categoryFilter.appendChild(option);
                    });

                    // Initial render
                    renderChannels();
                    updateChannelCount(allChannels.length);
                })
                .catch(error => {
                    console.error('Error loading channels:', error);
                    showError('Error Loading Channels', 'Unable to load channel data. Please make sure xchannels.json exists.');
                });

            // Get placeholder logo or return actual logo
            function getChannelLogo(channel) {
                if (!channel.logo || !channel.logo.trim()) {
                    return placeholderLogo;
                }
                return channel.logo;
            }

            // Render channels with optional filtering
            function renderChannels(categoryFilterValue = '', searchQuery = '') {
                if (animationFrameId) {
                    cancelAnimationFrame(animationFrameId);
                }

                animationFrameId = requestAnimationFrame(() => {
                    const startTime = performance.now();
                    let channels = allChannels;

                    // Filter by category
                    if (categoryFilterValue) {
                        channels = channels.filter(ch => ch.category === categoryFilterValue);
                    }

                    // Filter by search query
                    if (searchQuery) {
                        const query = searchQuery.toLowerCase();
                        channels = channels.filter(ch =>
                            ch.name.toLowerCase().includes(query)
                        );
                    }

                    filteredChannels = channels;
                    channelGrid.innerHTML = '';

                    // Show empty state if no results
                    if (channels.length === 0) {
                        showEmptyState();
                        updateChannelCount(0);
                        return;
                    }

                    // Create document fragment for better performance
                    const fragment = document.createDocumentFragment();

                    // Render channels in batches for performance
                    const batchSize = Math.min(50, channels.length);
                    for (let i = 0; i < batchSize; i++) {
                        const channel = channels[i];
                        const channelCard = createChannelCard(channel);
                        fragment.appendChild(channelCard);

                        // Break if taking too long (>16ms for 60fps)
                        if (performance.now() - startTime > 16) break;
                    }

                    channelGrid.appendChild(fragment);
                    updateChannelCount(channels.length);

                    // Load remaining channels asynchronously
                    if (channels.length > batchSize) {
                        setTimeout(() => {
                            loadRemainingChannels(channels, batchSize);
                        }, 100);
                    }

                    animationFrameId = null;
                });
            }

            // Load remaining channels in batches
            function loadRemainingChannels(channels, startIndex) {
                if (startIndex >= channels.length) return;

                const fragment = document.createDocumentFragment();
                const endIndex = Math.min(startIndex + 50, channels.length);

                for (let i = startIndex; i < endIndex; i++) {
                    const channelCard = createChannelCard(channels[i]);
                    fragment.appendChild(channelCard);
                }

                channelGrid.appendChild(fragment);

                if (endIndex < channels.length) {
                    setTimeout(() => {
                        loadRemainingChannels(channels, endIndex);
                    }, 50);
                }
            }

            // Create individual channel card element
            function createChannelCard(channel) {
                const card = document.createElement('div');
                card.className = 'channel-card';

                // Mark as active if it's the current playing channel
                if (currentChannel && currentChannel.url === channel.url) {
                    card.classList.add('active');
                }

                const logo = getChannelLogo(channel);

                card.innerHTML = `
                    <div class="channel-logo">
                        <img alt="${channel.name}" class="channel-img" loading="lazy" style="opacity: 0;">
                    </div>
                    <div class="channel-info">
                        <div class="channel-title">${channel.name}</div>
                        <div class="channel-cat">${channel.category}</div>
                        <div class="play-overlay">
                            <i class="fas fa-play"></i>
                        </div>
                    </div>
                `;

                const img = card.querySelector('.channel-img');

                // Use lazy loading observer if available
                if (lazyLoadObserver) {
                    img.dataset.src = logo;
                    lazyLoadObserver.observe(img);
                } else {
                    img.src = logo;
                }

                // Image load handler
                img.addEventListener('load', function () {
                    this.style.opacity = '1';
                });

                // Error handler for images
                img.addEventListener('error', function () {
                    this.src = placeholderLogo;
                    this.style.opacity = '0.7';
                });

                // Click handler to play channel
                card.addEventListener('click', (e) => {
                    e.preventDefault();
                    playChannel(channel);
                }, { passive: true });

                return card;
            }

            // Play selected channel
            function playChannel(channel) {
                // Update UI
                currentChannelName.textContent = channel.name;
                currentChannelCategory.textContent = channel.category;
                playerPlaceholder.style.display = 'none';
                nowPlaying.style.display = 'block';

                const jwPlayerElement = document.getElementById('my-jwplayer');
                jwPlayerElement.style.display = 'block';

                // Update active state
                const allCards = channelGrid.querySelectorAll('.channel-card');

                allCards.forEach(card => {
                    card.classList.remove('active');
                });

                // Find and mark new active card
                allCards.forEach(card => {
                    const titleElement = card.querySelector('.channel-title');
                    if (titleElement && titleElement.textContent === channel.name) {
                        card.classList.add('active');

                        // Scroll into view if needed
                        const cardRect = card.getBoundingClientRect();
                        const container = card.closest('.channels-container');
                        if (container) {
                            const containerRect = container.getBoundingClientRect();

                            if (cardRect.top < containerRect.top || cardRect.bottom > containerRect.bottom) {
                                card.scrollIntoView({
                                    behavior: 'smooth',
                                    block: 'nearest'
                                });
                            }
                        }
                    }
                });

                currentChannel = channel;

                // Initialize or update JW Player
                try {
                    if (jwPlayer) {
                        jwPlayer.load([{
                            file: channel.url,
                            type: 'hls'
                        }]);
                        jwPlayer.play();
                    } else {
                        jwPlayer = jwplayer('my-jwplayer').setup({
                            file: channel.url,
                            type: 'hls',
                            width: '100%',
                            height: '100%',
                            autostart: true,
                            mute: false,
                            controls: true,
                            preload: 'auto',
                            stretching: 'uniform',
                            skin: {
                                name: 'seven'
                            }
                        });

                        jwPlayer.on('error', function (event) {
                            console.error('JW Player error:', event);
                            showPlayerError();
                        });
                    }
                } catch (error) {
                    console.error('Error setting up player:', error);
                    showPlayerError();
                }
            }

            // Update channel count display
            function updateChannelCount(count) {
                channelsCount.textContent = count + ' Channel' + (count !== 1 ? 's' : '');
            }

            // Show empty state when no channels found
            function showEmptyState() {
                channelGrid.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-inbox"></i>
                        <h3>No channels found</h3>
                        <p>Try adjusting your search or category filter</p>
                    </div>
                `;
            }

            // Show error message
            function showError(title, message) {
                channelGrid.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-exclamation-triangle"></i>
                        <h3>${title}</h3>
                        <p>${message}</p>
                    </div>
                `;
            }

            // Show player error
            function showPlayerError() {
                playerPlaceholder.innerHTML = `
                    <i class="fas fa-exclamation-circle"></i>
                    <h3>Stream Error</h3>
                    <p>Unable to play this channel. Please try another one.</p>
                `;
                playerPlaceholder.style.display = 'flex';
                nowPlaying.style.display = 'none';
                document.getElementById('my-jwplayer').style.display = 'none';
            }

            // Debounced search function
            function handleSearch() {
                const currentTime = Date.now();
                if (currentTime - lastSearchTime < searchDebounceDelay) return;

                lastSearchTime = currentTime;

                if (animationFrameId) {
                    cancelAnimationFrame(animationFrameId);
                }

                animationFrameId = requestAnimationFrame(() => {
                    renderChannels(categoryFilter.value, searchBox.value);
                    animationFrameId = null;
                });
            }

            // Event Listeners
            categoryFilter.addEventListener('change', handleSearch);
            searchBox.addEventListener('input', handleSearch);

            // Prevent default on Enter
            searchBox.addEventListener('keydown', (e) => {
                if (e.key === 'Enter') {
                    e.preventDefault();
                }
            });

            // Global keyboard shortcuts
            document.addEventListener('keydown', (e) => {
                // Focus search box with '/'
                if (e.key === '/' && document.activeElement !== searchBox) {
                    e.preventDefault();
                    searchBox.focus();
                    return;
                }

                // Space to play/pause (only when not in search box)
                if (e.key === ' ' && document.activeElement !== searchBox && jwPlayer) {
                    e.preventDefault();

                    try {
                        if (jwPlayer.getState() === 'playing') {
                            jwPlayer.pause();
                        } else {
                            jwPlayer.play();
                        }
                    } catch (error) {
                        console.error('Error controlling player:', error);
                    }
                }

                // Clear search with Escape
                if (e.key === 'Escape' && document.activeElement === searchBox) {
                    searchBox.value = '';
                    renderChannels(categoryFilter.value, '');
                    searchBox.blur();
                }
            });

            // Cleanup on page unload
            window.addEventListener('beforeunload', () => {
                if (jwPlayer) {
                    try {
                        jwPlayer.remove();
                    } catch (error) {
                        console.error('Error removing player:', error);
                    }
                }

                if (lazyLoadObserver) {
                    lazyLoadObserver.disconnect();
                }

                if (animationFrameId) {
                    cancelAnimationFrame(animationFrameId);
                }
            });
        });
    </script>
</body>

</html>
